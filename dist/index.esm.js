import e from"vue";import t from"handsontable";function*n(e,t,n=1){if(n<=0)throw new Error("Step must be a positive number");for(;e<t;)yield e,e+=n}function o(e){if(Array.isArray(e))return e.map(o);if("object"==typeof e){if(null===e)return e;const t=Object.entries(e).map((([e,t])=>[e,o(t)]));return Object.fromEntries(t)}return e}function a(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!a(e[n],t[n]))return!1;return!0}if("object"==typeof e&&"object"==typeof t){if(null===e||null===t)return!1;const n=new Set(Object.keys(e)),o=new Set(Object.keys(t));if(n.size!==o.size)return!1;const i=new Set([...n,...o]);if(i.size!==n.size)return!1;for(const n of i){if(!a(e[n],t[n]))return!1}return!0}return!1}const i=new WeakMap,s=new WeakMap,r=new ResizeObserver((e=>e.forEach((({target:e})=>{var t;return null===(t=s.get(e))||void 0===t?void 0:t()}))));var l=e.extend({name:"Hot",props:{licenseKey:{type:String,required:!0},columns:{type:Array,required:!0},value:{type:Array,default:()=>[]},dataSchema:{type:Object},readOnly:{type:Boolean,default:!1},emptyCol:{type:Boolean,default:!1},stretchLast:{type:Boolean,default:!0}},computed:{staticConfig(){let{columns:e}=this;this.readOnly&&(e=e.map((e=>Object.assign({editor:!1},e)))),this.emptyCol&&e.push({data:"",title:" ",readOnly:!0});const t={columns:e,dataSchema:this.dataSchema,autoColumnSize:!0,manualColumnResize:!0,autoWrapRow:!0,stretchH:this.stretchLast?"last":"all",licenseKey:this.licenseKey,preventOverflow:"vertical"};return this.readOnly&&(t.beforePaste=()=>!1),t}},watch:{value(e){const t=this.instance();t.updateSettings({height:"auto"}),t.loadData(o(e)),t.validateRows([...n(0,e.length)]),this.hackyRenderSecondRun()},staticConfig(e){this.instance().updateSettings(e)}},methods:{instance(){return i.get(this)},hot(){const e=this.$refs.hot;if(!(e instanceof HTMLElement))throw new Error("No template reference is available");return e},requestRender(){var e,t;const n=null===(e=this.hot())||void 0===e?void 0:e.parentElement;n&&(null===(t=s.get(n))||void 0===t||t())},hackyRender(){const e=this.instance();e.updateSettings({height:"auto"}),e.render(),this.hackyRenderSecondRun()},hackyRenderSecondRun(){var e;const t=null===(e=this.hot())||void 0===e?void 0:e.parentElement;if(t){const{height:e,paddingTop:n,paddingBottom:o,boxSizing:a}=window.getComputedStyle(t);let i=parseFloat(e);"border-box"===a&&(i-=parseFloat(n)+parseFloat(o));const s=this.instance();s.updateSettings({height:i}),s.render()}},change(e,t){const n=this.instance(),o=n.getSourceData();a(o,this.value)||this.$emit("input",o),"fillIn"!==t&&null!==e&&this.$emit("change",e.map((([e,t,o,a])=>[n.toPhysicalRow(e),t,o,a])))},fillIn(e){const t=this.instance(),n=[];for(const[o,a]of e)for(const[e,i]of a)n.push([t.toVisualRow(o),e,i]);t.setDataAtRowProp(n,"fillIn")}},mounted(){var e;const a=this.hot(),l=new t(a,this.staticConfig),d=null===(e=this.hot())||void 0===e?void 0:e.parentElement;i.set(this,l),d&&(s.set(d,function(e,t){let n=null;return function(...o){null===n&&(n=window.setTimeout((()=>{n=null,e.apply(o)}),t))}}(this.hackyRender.bind(this),100)),r.observe(d)),l.addHook("afterChange",this.change.bind(this)),l.loadData(o(this.value)),l.validateRows([...n(0,this.value.length)])},beforeDestroy(){var e;i.delete(this);const t=null===(e=this.hot())||void 0===e?void 0:e.parentElement;t&&(s.delete(t),r.unobserve(t))}});function d(e,t,n,o,a,i,s,r,l,d){"boolean"!=typeof s&&(l=r,r=s,s=!1);const c="function"==typeof n?n.options:n;let h;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,a&&(c.functional=!0)),o&&(c._scopeId=o),i?(h=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=h):t&&(h=s?function(e){t.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),h)if(c.functional){const e=c.render;c.render=function(t,n){return h.call(n),e(t,n)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,h):[h]}return n}const c="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function h(e){return(e,t)=>function(e,t){const n=c?t.media||"default":e,o=p[n]||(p[n]={ids:new Set,styles:[]});if(!o.ids.has(e)){o.ids.add(e);let n=t.source;if(t.map&&(n+="\n/*# sourceURL="+t.map.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),o.element||(o.element=document.createElement("style"),o.element.type="text/css",t.media&&o.element.setAttribute("media",t.media),void 0===u&&(u=document.head||document.getElementsByTagName("head")[0]),u.appendChild(o.element)),"styleSheet"in o.element)o.styles.push(n),o.element.styleSheet.cssText=o.styles.filter(Boolean).join("\n");else{const e=o.ids.size-1,t=document.createTextNode(n),a=o.element.childNodes;a[e]&&o.element.removeChild(a[e]),a.length?o.element.insertBefore(t,a[e]):o.element.appendChild(t)}}}(e,t)}let u;const p={};const f=d({render:function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"hot",staticClass:"hot-mount"})},staticRenderFns:[]},(function(e){e&&e("data-v-23913bb4_0",{source:".handsontable[data-v-23913bb4] th{text-align:left;color:var(--hot-header-color);background:var(--hot-header-bg);letter-spacing:.8px;text-transform:uppercase;font-size:11px;font-weight:700}.handsontable[data-v-23913bb4] td,.handsontable[data-v-23913bb4] th{height:29px!important;line-height:30px;padding:2px 6px;border-color:var(--hot-border-color)!important}.handsontable[data-v-23913bb4] thead th .relative{padding:2px 6px}.handsontableInput[data-v-23913bb4]{line-height:30px;font-size:14px}",map:void 0,media:void 0})}),l,"data-v-23913bb4",false,undefined,!1,h,void 0,void 0);export{f as Hot};
